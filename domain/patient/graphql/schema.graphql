# Patient Domain GraphQL Schema

type Patient {
  id: ID!
  name: String!
  dob: Time!
  phone: String!
  state: String!
  createdAt: Time!
  addresses: [Address!]!
  prescriptions: [Prescription!]!
    @auth
    @permissionAny(
      requires: [
        "prescription:read"
        "doctor:role"
        "pharmacist:role"
        "admin:all"
      ]
    )
}

type Address {
  id: ID!
  patientID: ID!
  line1: String!
  line2: String
  city: String!
  state: String!
  zip: String!
}

input CreatePatientInput {
  name: String!
  dob: Time!
  phone: String!
  state: String!
}

input UpdatePatientInput {
  name: String
  dob: Time
  phone: String
  state: String
}

extend type Mutation {
  # Patient mutations - requires authentication and patient:write or admin:all permission
  createPatient(input: CreatePatientInput!): Patient
    @auth
    @permissionAny(requires: ["patient:write", "admin:all"])

  updatePatient(id: ID!, input: UpdatePatientInput!): Patient
    @auth
    @permissionAny(requires: ["patient:write", "admin:all"])
}
