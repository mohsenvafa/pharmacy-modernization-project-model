# Patient Domain GraphQL Schema

type Patient {
  id: ID!
  name: String!
  dob: Time!
  phone: String!
  state: String!
  createdAt: Time!
  addresses: [Address!]!
  prescriptions: [Prescription!]!
    @auth
    @permissionAny(
      requires: [
        "prescription:read"
        "doctor:role"
        "pharmacist:role"
        "admin:all"
      ]
    )
}

type Address {
  id: ID!
  patientID: ID!
  line1: String!
  line2: String
  city: String!
  state: String!
  zip: String!
}

input CreatePatientInput {
  name: String!
  dob: Time!
  phone: String!
  state: String!
}

input UpdatePatientInput {
  name: String
  dob: Time
  phone: String
  state: String
}

extend type Query {
  # Patient queries - requires authentication and patient:read or admin:all permission
  patient(id: ID!): Patient
    @auth
    @permissionAny(requires: ["patient:read", "admin:all"])

  patients(query: String, limit: Int, offset: Int): [Patient!]!
    @auth
    @permissionAny(requires: ["patient:read", "admin:all"])
}
